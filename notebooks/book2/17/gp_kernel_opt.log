An error occurred while executing the following cell:
------------------
try:
    from tinygp import kernels, GaussianProcess
except ModuleNotFoundError:
    %pip install -qq tinygp
    from tinygp import kernels, GaussianProcess

import jax
import jax.numpy as jnp

try:
    import flax.linen as nn
except ModuleNotFoundError:
    %pip install -qq flax
    import flax.linen as nn
from flax.linen.initializers import zeros

try:
    import optax
except ModuleNotFoundError:
    %pip install -qq optax
    import optax


class GPModule(nn.Module):
    @nn.compact
    def __call__(self, x, y, t):
        # t = test input locations
        # Returns loss (-log p(y|x)) and predictions p(y|t)
        mean = self.param("mean", zeros, ())
        log_jitter = self.param("log_jitter", zeros, ())

        log_sigma1 = self.param("log_sigma1", zeros, ())
        log_rho1 = self.param("log_rho1", zeros, ())
        log_tau = self.param("log_tau", zeros, ())
        kernel1 = (
            jnp.exp(2 * log_sigma1)
            * kernels.ExpSquared(jnp.exp(log_tau))
            * kernels.Cosine(jnp.exp(log_rho1))
        )

        log_sigma2 = self.param("log_sigma2", zeros, ())
        log_rho2 = self.param("log_rho2", zeros, ())
        kernel2 = jnp.exp(2 * log_sigma2) * kernels.Matern32(jnp.exp(log_rho2))

        kernel = kernel1 + kernel2
        gp = GaussianProcess(
            kernel, x, diag=jnp.exp(log_jitter), mean=mean
        )

        loss = -gp.condition(y)
        pred = gp.predict(y, t)

        return loss, pred


def loss(params):
    return model.apply(params, x, y, x_test)[0]


------------------

---------------------------------------------------------------------------
ModuleNotFoundError                       Traceback (most recent call last)
/tmp/ipykernel_4392/3123926733.py in <module>
     10 try:
---> 11     import flax.linen as nn
     12 except ModuleNotFoundError:

~/miniconda3/envs/py37/lib/python3.7/site-packages/flax/__init__.py in <module>
     18 from . import core as core
---> 19 from . import linen as linen
     20 from . import optim as optim

~/miniconda3/envs/py37/lib/python3.7/site-packages/flax/linen/__init__.py in <module>
     19 # re-export commonly used modules and functions
---> 20 from .activation import (
     21   PReLU as PReLU,

~/miniconda3/envs/py37/lib/python3.7/site-packages/flax/linen/activation.py in <module>
     21 
---> 22 from flax.linen.module import compact
     23 from flax.linen.module import Module

~/miniconda3/envs/py37/lib/python3.7/site-packages/flax/linen/module.py in <module>
     38     union_filters)
---> 39 from flax.linen import summary
     40 

~/miniconda3/envs/py37/lib/python3.7/site-packages/flax/linen/summary.py in <module>
     25 import rich.text
---> 26 import yaml
     27 

ModuleNotFoundError: No module named 'yaml'

During handling of the above exception, another exception occurred:

ModuleNotFoundError                       Traceback (most recent call last)
/tmp/ipykernel_4392/3123926733.py in <module>
     12 except ModuleNotFoundError:
     13     get_ipython().run_line_magic('pip', 'install -qq flax')
---> 14     import flax.linen as nn
     15 from flax.linen.initializers import zeros
     16 

~/miniconda3/envs/py37/lib/python3.7/site-packages/flax/__init__.py in <module>
     17 
     18 from . import core as core
---> 19 from . import linen as linen
     20 from . import optim as optim
     21 # DO NOT REMOVE - Marker for internal deprecated API.

~/miniconda3/envs/py37/lib/python3.7/site-packages/flax/linen/__init__.py in <module>
     18 # pylint: disable=g-multiple-import
     19 # re-export commonly used modules and functions
---> 20 from .activation import (
     21   PReLU as PReLU,
     22   celu as celu,

~/miniconda3/envs/py37/lib/python3.7/site-packages/flax/linen/activation.py in <module>
     20 from typing import Any, Optional
     21 
---> 22 from flax.linen.module import compact
     23 from flax.linen.module import Module
     24 

~/miniconda3/envs/py37/lib/python3.7/site-packages/flax/linen/module.py in <module>
     37     CollectionFilter, DenyList, FrozenVariableDict, Variable, VariableDict,
     38     union_filters)
---> 39 from flax.linen import summary
     40 
     41 

~/miniconda3/envs/py37/lib/python3.7/site-packages/flax/linen/summary.py in <module>
     24 import rich.table
     25 import rich.text
---> 26 import yaml
     27 
     28 PRNGKey = Any  # pylint: disable=invalid-name

ModuleNotFoundError: No module named 'yaml'
ModuleNotFoundError: No module named 'yaml'
