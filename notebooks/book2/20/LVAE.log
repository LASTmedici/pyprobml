An error occurred while executing the following cell:
------------------
from tkinter.tix import Tree
from unicodedata import name
from absl import app
from absl import flags
from typing import Any

try:
    import tensorflow as tf
except ModuleNotFoundError:
    %pip install -qq tensorflow
    import tensorflow as tf

try:
    import flax.linen as nn
except ModuleNotFoundError:
    %pip install -qq flax
    import flax.linen as nn
try:
    from probml_utils import savefig
except ModuleNotFoundError:
    %pip install git+https://github.com/probml/probml-utils.git
    from probml_utils import savefig

from flax.training import train_state, checkpoints
import shutil
import jax.numpy as jnp
import jax
from jax import random
import typing
from typing import Any
from typing import Sequence
import numpy as np

try:
    import optax
except ModuleNotFoundError:
    %pip install -qq optax
    import optax

try:
    import tensorflow_datasets as tfds
except ModuleNotFoundError:
    %pip install -qq tensorflow tensorflow_datasets
    import tensorflow_datasets as tfds


import scipy.io
import os
import math
import PIL
from PIL import Image
import matplotlib.pyplot as plt

os.environ["XLA_PYTHON_CLIENT_PREALLOCATE"] = "False"
------------------

---------------------------------------------------------------------------
ModuleNotFoundError                       Traceback (most recent call last)
/tmp/ipykernel_4064/3867189385.py in <module>
     13 try:
---> 14     import flax.linen as nn
     15 except ModuleNotFoundError:

ModuleNotFoundError: No module named 'flax'

During handling of the above exception, another exception occurred:

ModuleNotFoundError                       Traceback (most recent call last)
/tmp/ipykernel_4064/3867189385.py in <module>
     15 except ModuleNotFoundError:
     16     get_ipython().run_line_magic('pip', 'install -qq flax')
---> 17     import flax.linen as nn
     18 try:
     19     from probml_utils import savefig

~/miniconda3/envs/py37/lib/python3.7/site-packages/flax/__init__.py in <module>
     17 
     18 from . import core as core
---> 19 from . import linen as linen
     20 from . import optim as optim
     21 # DO NOT REMOVE - Marker for internal deprecated API.

~/miniconda3/envs/py37/lib/python3.7/site-packages/flax/linen/__init__.py in <module>
     18 # pylint: disable=g-multiple-import
     19 # re-export commonly used modules and functions
---> 20 from .activation import (
     21   PReLU as PReLU,
     22   celu as celu,

~/miniconda3/envs/py37/lib/python3.7/site-packages/flax/linen/activation.py in <module>
     20 from typing import Any, Optional
     21 
---> 22 from flax.linen.module import compact
     23 from flax.linen.module import Module
     24 

~/miniconda3/envs/py37/lib/python3.7/site-packages/flax/linen/module.py in <module>
     37     CollectionFilter, DenyList, FrozenVariableDict, Variable, VariableDict,
     38     union_filters)
---> 39 from flax.linen import summary
     40 
     41 

~/miniconda3/envs/py37/lib/python3.7/site-packages/flax/linen/summary.py in <module>
     24 import rich.table
     25 import rich.text
---> 26 import yaml
     27 
     28 PRNGKey = Any  # pylint: disable=invalid-name

ModuleNotFoundError: No module named 'yaml'
ModuleNotFoundError: No module named 'yaml'
